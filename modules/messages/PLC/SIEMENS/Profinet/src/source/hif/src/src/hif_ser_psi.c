/*****************************************************************************/
/*  Copyright (C) 2015 Siemens Aktiengesellschaft. All rights reserved.      */
/*****************************************************************************/
/*  This program is protected by German copyright law and international      */
/*  treaties. The use of this software including but not limited to its      */
/*  Source Code is subject to restrictions as agreed in the license          */
/*  agreement between you and Siemens.                                       */
/*  Copying or distribution is not allowed unless expressly permitted        */
/*  according to your license agreement with Siemens.                        */
/*****************************************************************************/
/*                                                                           */
/*  P r o j e c t         &P: PROFINET IO Runtime Software              :P&  */
/*                                                                           */
/*  P a c k a g e         &W: PROFINET IO Runtime Software              :W&  */
/*                                                                           */
/*  C o m p o n e n t     &C: HIF (Host Interface)                      :C&  */
/*                                                                           */
/*  F i l e               &F: hif_ser_psi.c                             :F&  */
/*                                                                           */
/*  V e r s i o n         &V: BC_PNRUN_P05.04.00.00_00.02.00.40         :V&  */
/*                                                                           */
/*  D a t e  (YYYY-MM-DD) &D: 2015-07-28                                :D&  */
/*                                                                           */
/*****************************************************************************/
/*                                                                           */
/*  D e s c r i p t i o n :                                                  */
/*                                                                           */
/*  Automatically generated with HIF Code Generator v2.1.0                   */
/*                                                                           */
/*                                                                           */
/*  !!!ATTENTION: Do not edit this file.                                     */
/*                Please use the HIF Code Generator to generate this file.   */
/*                                                                           */
/*  The hash value was automatically calculated by HIF Code Generator!       */
/*  HASH-VALUE: iwGXGA5brq189SeLb+n/xUeUma1bRyAS+MRh4maZRlQ=                 */
/*****************************************************************************/

#if defined( TOOL_CHAIN_MICROSOFT ) /* Microsoft Visual C++ */
#pragma component(browser, off, references)
#endif

#define HIF_MODULE_ID		35
#define LTRC_ACT_MODUL_ID	35

#include "hif_int.h"		

HIF_FILE_SYSTEM_EXTENSION(HIF_MODULE_ID)

#if ( (HIF_CFG_COMPILE_SERIALIZATION == 1) && (HIF_CFG_USE_PSI == 1) )


/* Prototypes */


/* Helper Functions */

/****************************************************************************
*  Name:        hif_psi_serialize_upper()
*  Purpose:     Function serializes the RQB to the HIF shared memory - 
*               according to the component ID and OP-code in the RQB.
*  Input:       pRqbSrc - pointer to the RQB, stored in the hosts local memory
*               pPipe   - pointer to pipe management structure
*  Output:      ppRqbDest - pointer to the RQB in the HIF shared memory
*  Return:      HIF_OK
*               HIF_ERR_RESOURCE
****************************************************************************/
LSA_UINT16  hif_psi_serialize_upper (
    HIF_SYS_HANDLE hSysDev,
    LSA_VOID*      pHifPipeHandle,
    LSA_INT        hShmPool,
    LSA_VOID*      pRqbSrc,
    LSA_VOID**     ppRqbDest,
    LSA_UINT32*    pSerRqbLen )
{
    LSA_UINT8* help_ptr = LSA_NULL;
    LSA_UINT32 rqb_size = 0;
    LSA_OPCODE_TYPE opcode = 0;
    PSI_RQB_TYPE* ptr_rqb_src = (PSI_RQB_TYPE*)pRqbSrc;
    LSA_VOID** ptr_ptr_rqb_dest = ppRqbDest;
    LSA_UINT32 i=0,j=0,k=0;
    LSA_UNUSED_ARG(hSysDev);
    LSA_UNUSED_ARG(pHifPipeHandle);

    HIF_ASSERT(HIF_IS_NOT_NULL(ptr_rqb_src)); /*#5*/
    opcode=HIF_RQB_GET_OPCODE(ptr_rqb_src);

    if (opcode==PSI_OPC_LD_OPEN_DEVICE)
    {
        rqb_size+=HIF_SER_SIZEOF(4);        /* original upper RQB pointer */
        rqb_size+=HIF_SER_SIZEOF_OPCODE_TYPE();        /* _opcode */
        rqb_size+=HIF_SER_SIZEOF_COMP_ID_TYPE();        /* _comp_id */
        rqb_size+=HIF_SER_SIZEOF(4);        /* hd_count */
        for(i=0;i<PSI_CFG_MAX_SOCK_APP_CHANNELS;i++)        /* sock_app_ch_details*/
        {
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_settings */
            rqb_size+=HIF_SER_SIZEOF(1);            /* SO_REUSEADDR_ */
            rqb_size+=HIF_SER_SIZEOF(1);            /* SO_DONTROUTE_ */
            rqb_size+=HIF_SER_SIZEOF(1);            /* SO_SNDBUF_ */
            rqb_size+=HIF_SER_SIZEOF(1);            /* SO_RCVBUF_ */
            rqb_size+=HIF_SER_SIZEOF(1);            /* SO_LINGER_ */
            rqb_size+=HIF_SER_SIZEOF(1);            /* SO_TCPNODELAY_ */
            rqb_size+=HIF_SER_SIZEOF(1);            /* SO_TCPNOACKDELAY_ */
            rqb_size+=HIF_SER_SIZEOF(4);            /* send_buffer_max_len */
            rqb_size+=HIF_SER_SIZEOF(4);            /* rec_buffer_max_len */
            rqb_size+=HIF_SER_SIZEOF(2);            /* sock_close_at_once */
            rqb_size+=HIF_SER_SIZEOF(2);            /* linger_time */
        }
        rqb_size+=HIF_SER_SIZEOF(2);        /* vendor_id_high */
        rqb_size+=HIF_SER_SIZEOF(2);        /* vendor_id_low */
        rqb_size+=HIF_SER_SIZEOF(2);        /* hw_revision */
        rqb_size+=HIF_SER_SIZEOF(1);        /* revision_prefix */
        rqb_size+=HIF_SER_SIZEOF(1);        /* functional_enhancement */
        rqb_size+=HIF_SER_SIZEOF(1);        /* bug_fix */
        rqb_size+=HIF_SER_SIZEOF(1);        /* internal_change */
        rqb_size+=HIF_SER_SIZEOF(2);        /* revision_counter */
        rqb_size+=HIF_SER_SIZEOF(2);        /* profile_id */
        rqb_size+=HIF_SER_SIZEOF(2);        /* profile_specific_type */
        rqb_size+=HIF_SER_SIZEOF(2);        /* version */
        rqb_size+=HIF_SER_SIZEOF(2);        /* supported */
        rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAX_SIZE_IM_ORDER_ID);        /* order_id */
        rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAX_SIZE_IM_DEVICE_TYPE);        /* device_type */
        for(i=0;i<ptr_rqb_src->args.ld_open.hd_count;i++)        /* hd_args*/
        {
            rqb_size+=HIF_SER_SIZEOF(2);            /* hd_id */
            rqb_size+=HIF_SER_SIZEOF(2);            /* hd_selection */
            rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);            /* hd_mac */
            rqb_size+=HIF_SER_SIZEOF(2);            /* bus_nr */
            rqb_size+=HIF_SER_SIZEOF(2);            /* device_nr */
            rqb_size+=HIF_SER_SIZEOF(2);            /* function_nr */
            rqb_size+=HIF_SER_SIZEOF(1);            /* runs_on_level_basic */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_ports */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_if */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_all_ports */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_all_if */
            rqb_size+=HIF_SER_SIZEOF(2);            /* edd_type */
            rqb_size+=HIF_SER_SIZEOF(2);            /* asic_type */
            rqb_size+=HIF_SER_SIZEOF(2);            /* rev_nr */
            rqb_size+=HIF_SER_SIZEOF(1);            /* allow_none_pnio_mautypes */
            rqb_size+=HIF_SER_SIZEOF(2);            /* send_clock_factor */
            for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)            /* if_mac*/
            {
                rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);                /*  */
            }
            for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)            /* port_mac*/
            {
                rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);                /*  */
            }
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(1);            /* irt_supported */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_irt_forwarder */
            rqb_size+=HIF_SER_SIZEOF(2);            /* reserved_ram_for_time */
            rqb_size+=HIF_SER_SIZEOF(1);            /* support_irt_flex */
            rqb_size+=HIF_SER_SIZEOF(1);            /* disable_max_port_delay_check */
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(2);            /* k32fw_trace_level */
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(1);            /* gigabit_support */
            rqb_size+=HIF_SER_SIZEOF(1);            /* nrt_copy_interface */
            for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)            /* hw_port*/
            {
                rqb_size+=HIF_SER_SIZEOF(2);                /* if_nr */
                rqb_size+=HIF_SER_SIZEOF(2);                /* user_nr */
                rqb_size+=HIF_SER_SIZEOF(2);                /* mrp_ringport_type */
            }
            for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)            /* pnio_if*/
            {
                rqb_size+=HIF_SER_SIZEOF(4);                /* if_id */
                rqb_size+=HIF_SER_SIZEOF(2);                /* edd_if_id */
                rqb_size+=HIF_SER_SIZEOF(4);                /* trace_idx */
                rqb_size+=HIF_SER_SIZEOF(1);                /* use_setting */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_rt_devices */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_irt_devices */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_qv_provider */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_qv_consumer */
                rqb_size+=HIF_SER_SIZEOF(2);                /* logical_addr_space */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_submod */
                rqb_size+=HIF_SER_SIZEOF(2);                /* max_iocr_data_size */
                rqb_size+=HIF_SER_SIZEOF(2);                /* max_mcr_data_size */
                rqb_size+=HIF_SER_SIZEOF(4);                /* max_record_length */
                rqb_size+=HIF_SER_SIZEOF(2);                /* max_alarm_data_length */
                rqb_size+=HIF_SER_SIZEOF(2);                /* max_read_implicit */
                rqb_size+=HIF_SER_SIZEOF(1);                /* use_setting */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_instances */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_ar */
                rqb_size+=HIF_SER_SIZEOF(2);                /* max_icr_data_size */
                rqb_size+=HIF_SER_SIZEOF(2);                /* max_ocr_data_size */
                rqb_size+=HIF_SER_SIZEOF(2);                /* max_mcr_data_size */
                rqb_size+=HIF_SER_SIZEOF(4);                /* max_record_length */
                rqb_size+=HIF_SER_SIZEOF(2);                /* max_alarm_data_length */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_read_implicit */
                rqb_size+=HIF_SER_SIZEOF(1);                /* use_setting */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_provider_con */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_consumer_con */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_rt_provider */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_rt_consumer */
                rqb_size+=HIF_SER_SIZEOF(2);                /* data_volume_size */
                rqb_size+=HIF_SER_SIZEOF(1);                /* use_setting */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_send */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_arp */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_icmp */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_udp */
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_tcp  */
                rqb_size+=HIF_SER_SIZEOF(1);                /* multicast_support_on */
                rqb_size+=HIF_SER_SIZEOF(1);                /* use_setting */
                rqb_size+=HIF_SER_SIZEOF(2);                /* vendor_id */
                rqb_size+=HIF_SER_SIZEOF(2);                /* device_id */
                rqb_size+=HIF_SER_SIZEOF(4);                /* instance_opt */
                rqb_size+=HIF_SER_SIZEOF(2);                /* check_interval */
                rqb_size+=HIF_SER_SIZEOF(1);                /* check_ip_enabled */
                rqb_size+=HIF_SER_SIZEOF(1);                /* nos_allow_upper_cases */
                rqb_size+=HIF_SER_SIZEOF(1);                /* use_setting */
                rqb_size+=HIF_SER_SIZEOF(1);                /* max_instances */
                rqb_size+=HIF_SER_SIZEOF(1);                /* supported_role */
                rqb_size+=HIF_SER_SIZEOF(1);                /* supported_multiple_role */
                rqb_size+=HIF_SER_SIZEOF(2);                /* default_role_instance0 */
                rqb_size+=HIF_SER_SIZEOF(1);                /* RxFilterUDP_Unicast */
                rqb_size+=HIF_SER_SIZEOF(1);                /* RxFilterUDP_Broadcast */
            }
        }
        HIF_ALLOC_SER_MEM((LSA_VOID**)(&help_ptr), rqb_size, hSysDev, hShmPool);
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_serialize_upper() opc(%d) rqb_size_shm(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,ptr_rqb_src);

        if (HIF_IS_NULL(help_ptr))
        {
            return HIF_ERR_RESOURCE;
        }

        *ptr_ptr_rqb_dest = help_ptr;
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src);                /* original upper RQB pointer */

        HIF_SER_OPCODE_HTSHM((LSA_UINT32**)&help_ptr,opcode);                /* _opcode */
        HIF_SER_COMP_ID_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_COMP_ID(ptr_rqb_src));                /* _comp_id */
        /* INFO: serialize the array size right after the pointer */
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_count);                /* hd_count */
        for(i=0;i<PSI_CFG_MAX_SOCK_APP_CHANNELS;i++)                                /* sock_app_ch_details*/
        {
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].use_settings);                        /* use_settings */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_REUSEADDR_);                        /* SO_REUSEADDR_ */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_DONTROUTE_);                        /* SO_DONTROUTE_ */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_SNDBUF_);                        /* SO_SNDBUF_ */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_RCVBUF_);                        /* SO_RCVBUF_ */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_LINGER_);                        /* SO_LINGER_ */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_TCPNODELAY_);                        /* SO_TCPNODELAY_ */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_TCPNOACKDELAY_);                        /* SO_TCPNOACKDELAY_ */
            HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.send_buffer_max_len);                        /* send_buffer_max_len */
            HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.rec_buffer_max_len);                        /* rec_buffer_max_len */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.sock_close_at_once);                        /* sock_close_at_once */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.linger_time);                        /* linger_time */
        }
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.vendor_id_high);                /* vendor_id_high */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.vendor_id_low);                /* vendor_id_low */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.hw_revision);                /* hw_revision */
        HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.sw_version.revision_prefix);                /* revision_prefix */
        HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.sw_version.functional_enhancement);                /* functional_enhancement */
        HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.sw_version.bug_fix);                /* bug_fix */
        HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.sw_version.internal_change);                /* internal_change */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.revision_counter);                /* revision_counter */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.profile_id);                /* profile_id */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.profile_specific_type);                /* profile_specific_type */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.version);                /* version */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.supported);                /* supported */
        for(i=0;i<PSI_MAX_SIZE_IM_ORDER_ID;i++)                        /* im_args*/
        {
            HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.order_id[i]);                /* order_id */
        }
        for(i=0;i<PSI_MAX_SIZE_IM_DEVICE_TYPE;i++)                        /* im_args*/
        {
            HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.im_args.device_type[i]);                /* device_type */
        }
        for(i=0;i<ptr_rqb_src->args.ld_open.hd_count;i++)                                /* hd_args*/
        {
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_id);                        /* hd_id */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_selection);                        /* hd_selection */
            for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                    /* hd_location*/
            {
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_mac[j]);                        /* hd_mac */
            }
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_location.bus_nr);                        /* bus_nr */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_location.device_nr);                        /* device_nr */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_location.function_nr);                        /* function_nr */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].runs_on_level_basic);                        /* runs_on_level_basic */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].nr_of_ports);                        /* nr_of_ports */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].nr_of_if);                        /* nr_of_if */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].nr_of_all_ports);                        /* nr_of_all_ports */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].nr_of_all_if);                        /* nr_of_all_if */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].edd_type);                        /* edd_type */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].asic_type);                        /* asic_type */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].rev_nr);                        /* rev_nr */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].allow_none_pnio_mautypes);                        /* allow_none_pnio_mautypes */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].send_clock_factor);                        /* send_clock_factor */
            for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)                                                /* if_mac*/
            {
                for(k=0;k<PSI_MAC_ADDR_SIZE;k++)                                                /* if_mac*/
                {
                    HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].if_mac[j][k]);                                /*  */
                }
            }
            for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)                                                /* port_mac*/
            {
                for(k=0;k<PSI_MAC_ADDR_SIZE;k++)                                                /* port_mac*/
                {
                    HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].port_mac[j][k]);                                /*  */
                }
            }
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].irte.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].irte.irt_supported);                        /* irt_supported */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].irte.nr_irt_forwarder);                        /* nr_irt_forwarder */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].irte.reserved_ram_for_time);                        /* reserved_ram_for_time */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].irte.support_irt_flex);                        /* support_irt_flex */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].irte.disable_max_port_delay_check);                        /* disable_max_port_delay_check */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnip.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnip.k32fw_trace_level);                        /* k32fw_trace_level */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].stdmac.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].stdmac.gigabit_support);                        /* gigabit_support */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].stdmac.nrt_copy_interface);                        /* nrt_copy_interface */
            for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)                                                /* hw_port*/
            {
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hw_port[j].if_nr);                                /* if_nr */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hw_port[j].user_nr);                                /* user_nr */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hw_port[j].mrp_ringport_type);                                /* mrp_ringport_type */
            }
            for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)                                                /* pnio_if*/
            {
                HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].if_id);                                /* if_id */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].edd_if_id);                                /* edd_if_id */
                HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].trace_idx);                                /* trace_idx */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.use_setting);                                /* use_setting */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_rt_devices);                                /* nr_of_rt_devices */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_irt_devices);                                /* nr_of_irt_devices */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_qv_provider);                                /* nr_of_qv_provider */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_qv_consumer);                                /* nr_of_qv_consumer */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.logical_addr_space);                                /* logical_addr_space */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_submod);                                /* nr_of_submod */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.max_iocr_data_size);                                /* max_iocr_data_size */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.max_mcr_data_size);                                /* max_mcr_data_size */
                HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.max_record_length);                                /* max_record_length */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.max_alarm_data_length);                                /* max_alarm_data_length */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ioc.max_read_implicit);                                /* max_read_implicit */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.use_setting);                                /* use_setting */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.nr_of_instances);                                /* nr_of_instances */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.nr_of_ar);                                /* nr_of_ar */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.max_icr_data_size);                                /* max_icr_data_size */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.max_ocr_data_size);                                /* max_ocr_data_size */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.max_mcr_data_size);                                /* max_mcr_data_size */
                HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.max_record_length);                                /* max_record_length */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.max_alarm_data_length);                                /* max_alarm_data_length */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].iod.nr_of_read_implicit);                                /* nr_of_read_implicit */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].cba.use_setting);                                /* use_setting */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].cba.nr_of_provider_con);                                /* nr_of_provider_con */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].cba.nr_of_consumer_con);                                /* nr_of_consumer_con */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].cba.nr_of_rt_provider);                                /* nr_of_rt_provider */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].cba.nr_of_rt_consumer);                                /* nr_of_rt_consumer */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].cba.data_volume_size);                                /* data_volume_size */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ip.use_setting);                                /* use_setting */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_send);                                /* nr_of_send */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_arp);                                /* nr_of_arp */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_icmp);                                /* nr_of_icmp */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_udp);                                /* nr_of_udp */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_tcp );                                /* nr_of_tcp  */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].ip.multicast_support_on);                                /* multicast_support_on */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].oha.use_setting);                                /* use_setting */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].oha.vendor_id);                                /* vendor_id */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].oha.device_id);                                /* device_id */
                HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].oha.instance_opt);                                /* instance_opt */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].oha.check_interval);                                /* check_interval */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].oha.check_ip_enabled);                                /* check_ip_enabled */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].oha.nos_allow_upper_cases);                                /* nos_allow_upper_cases */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].mrp.use_setting);                                /* use_setting */
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].mrp.max_instances);                                /* max_instances */
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].mrp.supported_role);                                /* supported_role */
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].mrp.supported_multiple_role);                                /* supported_multiple_role */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].mrp.default_role_instance0);                                /* default_role_instance0 */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].nrt.RxFilterUDP_Unicast);                                /* RxFilterUDP_Unicast */
                HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].pnio_if[j].nrt.RxFilterUDP_Broadcast);                                /* RxFilterUDP_Broadcast */
            }
        }
    }
    else if (opcode==PSI_OPC_HD_OPEN_DEVICE)
    {
        rqb_size+=HIF_SER_SIZEOF(4);        /* original upper RQB pointer */
        rqb_size+=HIF_SER_SIZEOF_OPCODE_TYPE();        /* _opcode */
        rqb_size+=HIF_SER_SIZEOF_COMP_ID_TYPE();        /* _comp_id */
        rqb_size+=HIF_SER_SIZEOF(2);        /* hd_id */
        rqb_size+=HIF_SER_SIZEOF(2);        /* hd_selection */
        rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);        /* hd_mac */
        rqb_size+=HIF_SER_SIZEOF(2);        /* bus_nr */
        rqb_size+=HIF_SER_SIZEOF(2);        /* device_nr */
        rqb_size+=HIF_SER_SIZEOF(2);        /* function_nr */
        rqb_size+=HIF_SER_SIZEOF(1);        /* runs_on_level_basic */
        rqb_size+=HIF_SER_SIZEOF(2);        /* nr_of_ports */
        rqb_size+=HIF_SER_SIZEOF(2);        /* nr_of_if */
        rqb_size+=HIF_SER_SIZEOF(2);        /* nr_of_all_ports */
        rqb_size+=HIF_SER_SIZEOF(2);        /* nr_of_all_if */
        rqb_size+=HIF_SER_SIZEOF(2);        /* edd_type */
        rqb_size+=HIF_SER_SIZEOF(2);        /* asic_type */
        rqb_size+=HIF_SER_SIZEOF(2);        /* rev_nr */
        rqb_size+=HIF_SER_SIZEOF(1);        /* allow_none_pnio_mautypes */
        rqb_size+=HIF_SER_SIZEOF(2);        /* send_clock_factor */
        for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)        /* if_mac*/
        {
            rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);            /*  */
        }
        for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)        /* port_mac*/
        {
            rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);            /*  */
        }
        rqb_size+=HIF_SER_SIZEOF(1);        /* use_setting */
        rqb_size+=HIF_SER_SIZEOF(1);        /* irt_supported */
        rqb_size+=HIF_SER_SIZEOF(2);        /* nr_irt_forwarder */
        rqb_size+=HIF_SER_SIZEOF(2);        /* reserved_ram_for_time */
        rqb_size+=HIF_SER_SIZEOF(1);        /* support_irt_flex */
        rqb_size+=HIF_SER_SIZEOF(1);        /* disable_max_port_delay_check */
        rqb_size+=HIF_SER_SIZEOF(1);        /* use_setting */
        rqb_size+=HIF_SER_SIZEOF(2);        /* k32fw_trace_level */
        rqb_size+=HIF_SER_SIZEOF(1);        /* use_setting */
        rqb_size+=HIF_SER_SIZEOF(1);        /* gigabit_support */
        rqb_size+=HIF_SER_SIZEOF(1);        /* nrt_copy_interface */
        for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)        /* hw_port*/
        {
            rqb_size+=HIF_SER_SIZEOF(2);            /* if_nr */
            rqb_size+=HIF_SER_SIZEOF(2);            /* user_nr */
            rqb_size+=HIF_SER_SIZEOF(2);            /* mrp_ringport_type */
        }
        for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)        /* pnio_if*/
        {
            rqb_size+=HIF_SER_SIZEOF(4);            /* if_id */
            rqb_size+=HIF_SER_SIZEOF(2);            /* edd_if_id */
            rqb_size+=HIF_SER_SIZEOF(4);            /* trace_idx */
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_rt_devices */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_irt_devices */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_qv_provider */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_qv_consumer */
            rqb_size+=HIF_SER_SIZEOF(2);            /* logical_addr_space */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_submod */
            rqb_size+=HIF_SER_SIZEOF(2);            /* max_iocr_data_size */
            rqb_size+=HIF_SER_SIZEOF(2);            /* max_mcr_data_size */
            rqb_size+=HIF_SER_SIZEOF(4);            /* max_record_length */
            rqb_size+=HIF_SER_SIZEOF(2);            /* max_alarm_data_length */
            rqb_size+=HIF_SER_SIZEOF(2);            /* max_read_implicit */
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_instances */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_ar */
            rqb_size+=HIF_SER_SIZEOF(2);            /* max_icr_data_size */
            rqb_size+=HIF_SER_SIZEOF(2);            /* max_ocr_data_size */
            rqb_size+=HIF_SER_SIZEOF(2);            /* max_mcr_data_size */
            rqb_size+=HIF_SER_SIZEOF(4);            /* max_record_length */
            rqb_size+=HIF_SER_SIZEOF(2);            /* max_alarm_data_length */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_read_implicit */
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_provider_con */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_consumer_con */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_rt_provider */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_rt_consumer */
            rqb_size+=HIF_SER_SIZEOF(2);            /* data_volume_size */
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_send */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_arp */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_icmp */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_udp */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_tcp  */
            rqb_size+=HIF_SER_SIZEOF(1);            /* multicast_support_on */
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(2);            /* vendor_id */
            rqb_size+=HIF_SER_SIZEOF(2);            /* device_id */
            rqb_size+=HIF_SER_SIZEOF(4);            /* instance_opt */
            rqb_size+=HIF_SER_SIZEOF(2);            /* check_interval */
            rqb_size+=HIF_SER_SIZEOF(1);            /* check_ip_enabled */
            rqb_size+=HIF_SER_SIZEOF(1);            /* nos_allow_upper_cases */
            rqb_size+=HIF_SER_SIZEOF(1);            /* use_setting */
            rqb_size+=HIF_SER_SIZEOF(1);            /* max_instances */
            rqb_size+=HIF_SER_SIZEOF(1);            /* supported_role */
            rqb_size+=HIF_SER_SIZEOF(1);            /* supported_multiple_role */
            rqb_size+=HIF_SER_SIZEOF(2);            /* default_role_instance0 */
            rqb_size+=HIF_SER_SIZEOF(1);            /* RxFilterUDP_Unicast */
            rqb_size+=HIF_SER_SIZEOF(1);            /* RxFilterUDP_Broadcast */
        }
        HIF_ALLOC_SER_MEM((LSA_VOID**)(&help_ptr), rqb_size, hSysDev, hShmPool);
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_serialize_upper() opc(%d) rqb_size_shm(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,ptr_rqb_src);

        if (HIF_IS_NULL(help_ptr))
        {
            return HIF_ERR_RESOURCE;
        }

        *ptr_ptr_rqb_dest = help_ptr;
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src);                /* original upper RQB pointer */

        HIF_SER_OPCODE_HTSHM((LSA_UINT32**)&help_ptr,opcode);                /* _opcode */
        HIF_SER_COMP_ID_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_COMP_ID(ptr_rqb_src));                /* _comp_id */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_id);                /* hd_id */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_selection);                /* hd_selection */
        for(i=0;i<PSI_MAC_ADDR_SIZE;i++)                        /* hd_location*/
        {
            HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_mac[i]);                /* hd_mac */
        }
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_location.bus_nr);                /* bus_nr */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_location.device_nr);                /* device_nr */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_location.function_nr);                /* function_nr */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.runs_on_level_basic);                /* runs_on_level_basic */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.nr_of_ports);                /* nr_of_ports */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.nr_of_if);                /* nr_of_if */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.nr_of_all_ports);                /* nr_of_all_ports */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.nr_of_all_if);                /* nr_of_all_if */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.edd_type);                /* edd_type */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.asic_type);                /* asic_type */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.rev_nr);                /* rev_nr */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.allow_none_pnio_mautypes);                /* allow_none_pnio_mautypes */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.send_clock_factor);                /* send_clock_factor */
        for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)                                /* if_mac*/
        {
            for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                    /* if_mac*/
            {
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.if_mac[i][j]);                        /*  */
            }
        }
        for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)                                /* port_mac*/
        {
            for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                    /* port_mac*/
            {
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.port_mac[i][j]);                        /*  */
            }
        }
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.irte.use_setting);                /* use_setting */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.irte.irt_supported);                /* irt_supported */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.irte.nr_irt_forwarder);                /* nr_irt_forwarder */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.irte.reserved_ram_for_time);                /* reserved_ram_for_time */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.irte.support_irt_flex);                /* support_irt_flex */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.irte.disable_max_port_delay_check);                /* disable_max_port_delay_check */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnip.use_setting);                /* use_setting */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnip.k32fw_trace_level);                /* k32fw_trace_level */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.stdmac.use_setting);                /* use_setting */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.stdmac.gigabit_support);                /* gigabit_support */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.stdmac.nrt_copy_interface);                /* nrt_copy_interface */
        for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)                                /* hw_port*/
        {
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hw_port[i].if_nr);                        /* if_nr */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hw_port[i].user_nr);                        /* user_nr */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hw_port[i].mrp_ringport_type);                        /* mrp_ringport_type */
        }
        for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)                                /* pnio_if*/
        {
            HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].if_id);                        /* if_id */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].edd_if_id);                        /* edd_if_id */
            HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].trace_idx);                        /* trace_idx */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_rt_devices);                        /* nr_of_rt_devices */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_irt_devices);                        /* nr_of_irt_devices */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_qv_provider);                        /* nr_of_qv_provider */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_qv_consumer);                        /* nr_of_qv_consumer */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.logical_addr_space);                        /* logical_addr_space */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_submod);                        /* nr_of_submod */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.max_iocr_data_size);                        /* max_iocr_data_size */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.max_mcr_data_size);                        /* max_mcr_data_size */
            HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.max_record_length);                        /* max_record_length */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.max_alarm_data_length);                        /* max_alarm_data_length */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ioc.max_read_implicit);                        /* max_read_implicit */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.nr_of_instances);                        /* nr_of_instances */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.nr_of_ar);                        /* nr_of_ar */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.max_icr_data_size);                        /* max_icr_data_size */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.max_ocr_data_size);                        /* max_ocr_data_size */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.max_mcr_data_size);                        /* max_mcr_data_size */
            HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.max_record_length);                        /* max_record_length */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.max_alarm_data_length);                        /* max_alarm_data_length */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].iod.nr_of_read_implicit);                        /* nr_of_read_implicit */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].cba.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].cba.nr_of_provider_con);                        /* nr_of_provider_con */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].cba.nr_of_consumer_con);                        /* nr_of_consumer_con */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].cba.nr_of_rt_provider);                        /* nr_of_rt_provider */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].cba.nr_of_rt_consumer);                        /* nr_of_rt_consumer */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].cba.data_volume_size);                        /* data_volume_size */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ip.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ip.nr_of_send);                        /* nr_of_send */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ip.nr_of_arp);                        /* nr_of_arp */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ip.nr_of_icmp);                        /* nr_of_icmp */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ip.nr_of_udp);                        /* nr_of_udp */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ip.nr_of_tcp );                        /* nr_of_tcp  */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].ip.multicast_support_on);                        /* multicast_support_on */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].oha.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].oha.vendor_id);                        /* vendor_id */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].oha.device_id);                        /* device_id */
            HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].oha.instance_opt);                        /* instance_opt */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].oha.check_interval);                        /* check_interval */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].oha.check_ip_enabled);                        /* check_ip_enabled */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].oha.nos_allow_upper_cases);                        /* nos_allow_upper_cases */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].mrp.use_setting);                        /* use_setting */
            HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].mrp.max_instances);                        /* max_instances */
            HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].mrp.supported_role);                        /* supported_role */
            HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].mrp.supported_multiple_role);                        /* supported_multiple_role */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].mrp.default_role_instance0);                        /* default_role_instance0 */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].nrt.RxFilterUDP_Unicast);                        /* RxFilterUDP_Unicast */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.pnio_if[i].nrt.RxFilterUDP_Broadcast);                        /* RxFilterUDP_Broadcast */
        }
    }
    else if (opcode==PSI_OPC_LD_CLOSE_DEVICE)
    {
        rqb_size+=HIF_SER_SIZEOF(4);        /* original upper RQB pointer */
        rqb_size+=HIF_SER_SIZEOF_OPCODE_TYPE();        /* _opcode */
        rqb_size+=HIF_SER_SIZEOF_COMP_ID_TYPE();        /* _comp_id */
        HIF_ALLOC_SER_MEM((LSA_VOID**)(&help_ptr), rqb_size, hSysDev, hShmPool);
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_serialize_upper() opc(%d) rqb_size_shm(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,ptr_rqb_src);

        if (HIF_IS_NULL(help_ptr))
        {
            return HIF_ERR_RESOURCE;
        }

        *ptr_ptr_rqb_dest = help_ptr;
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src);                /* original upper RQB pointer */

        HIF_SER_OPCODE_HTSHM((LSA_UINT32**)&help_ptr,opcode);                /* _opcode */
        HIF_SER_COMP_ID_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_COMP_ID(ptr_rqb_src));                /* _comp_id */
    }
    else if (opcode==PSI_OPC_HD_CLOSE_DEVICE)
    {
        rqb_size+=HIF_SER_SIZEOF(4);        /* original upper RQB pointer */
        rqb_size+=HIF_SER_SIZEOF_OPCODE_TYPE();        /* _opcode */
        rqb_size+=HIF_SER_SIZEOF_COMP_ID_TYPE();        /* _comp_id */
        rqb_size+=HIF_SER_SIZEOF(4);        /* hd_id */
        HIF_ALLOC_SER_MEM((LSA_VOID**)(&help_ptr), rqb_size, hSysDev, hShmPool);
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_serialize_upper() opc(%d) rqb_size_shm(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,ptr_rqb_src);

        if (HIF_IS_NULL(help_ptr))
        {
            return HIF_ERR_RESOURCE;
        }

        *ptr_ptr_rqb_dest = help_ptr;
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src);                /* original upper RQB pointer */

        HIF_SER_OPCODE_HTSHM((LSA_UINT32**)&help_ptr,opcode);                /* _opcode */
        HIF_SER_COMP_ID_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_COMP_ID(ptr_rqb_src));                /* _comp_id */
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_close.hd_id);                /* hd_id */
    }
    else
    {
        HIF_PROGRAM_TRACE_02(0,LSA_TRACE_LEVEL_FATAL,"hif_psi_serialize_upper(). RQB-Opcode:0x%x is not valid! pRQB(0x%08x)",opcode,ptr_rqb_src+4);
        HIF_FATAL(0);
    }

    *pSerRqbLen = rqb_size;

    HIF_ASSERT(HIF_IS_NOT_NULL(help_ptr)); /*#4*/

    /* Check for overwrite */
    HIF_SHM_CHECK_OVERWRITE_SERIALIZE(opcode, *ptr_ptr_rqb_dest, rqb_size, help_ptr, "hif_psi_serialize_upper");

    return HIF_OK;
}

/****************************************************************************
*  Name:        hif_psi_serialize_lower()
*  Purpose:     Function serializes the RQB to the HIF shared memory - 
*               according to the component ID and OP-code in the RQB.
*  Input:       pRqbSrc - pointer to the RQB, stored in the hosts local memory
*               pPipe   - pointer to pipe management structure
*  Output:      ppRqbDest - pointer to the RQB in the HIF shared memory
*  Return:      HIF_OK
*               HIF_ERR_RESOURCE
****************************************************************************/
LSA_UINT16  hif_psi_serialize_lower (
    HIF_SYS_HANDLE hSysDev,
    LSA_VOID*      pHifPipeHandle,
    LSA_INT        hShmPool,
    LSA_VOID*      pRqbSrc,
    LSA_VOID**     ppRqbDest,
    LSA_UINT32*    pSerRqbLen )
{
    LSA_UINT8* help_ptr = LSA_NULL;
    LSA_UINT32 rqb_size = 0;
    LSA_OPCODE_TYPE opcode = 0;
    PSI_RQB_TYPE* ptr_rqb_src = (PSI_RQB_TYPE*)pRqbSrc;
    LSA_VOID** ptr_ptr_rqb_dest = ppRqbDest;
    LSA_UINT16 freeRes = 0;
    LSA_UINT32 i=0,j=0,k=0;
    LSA_UNUSED_ARG(hSysDev);
    LSA_UNUSED_ARG(pHifPipeHandle);

    HIF_ASSERT(HIF_IS_NOT_NULL(ptr_rqb_src)); /*#5*/
    opcode=HIF_RQB_GET_OPCODE(ptr_rqb_src);

    if (opcode==PSI_OPC_LD_OPEN_DEVICE)
    {
        rqb_size+=HIF_SER_SIZEOF(4);        /* original upper RQB pointer */
        rqb_size+=HIF_SER_SIZEOF_OPCODE_TYPE();        /* _opcode */
        rqb_size+=HIF_SER_SIZEOF_COMP_ID_TYPE();        /* _comp_id */
        rqb_size+=HIF_SER_SIZEOF_RESPONSE_TYPE();        /* _response */
        rqb_size+=HIF_SER_SIZEOF(4);        /* hd_count */
        for(i=0;i<ptr_rqb_src->args.ld_open.hd_count;i++)        /* hd_args*/
        {
            rqb_size+=HIF_SER_SIZEOF(2);            /* hd_id */
            rqb_size+=HIF_SER_SIZEOF(2);            /* hd_selection */
            rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);            /* hd_mac */
            rqb_size+=HIF_SER_SIZEOF(2);            /* bus_nr */
            rqb_size+=HIF_SER_SIZEOF(2);            /* device_nr */
            rqb_size+=HIF_SER_SIZEOF(2);            /* function_nr */
            rqb_size+=HIF_SER_SIZEOF(1);            /* runs_on_level_basic */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_ports */
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_all_ports */
            rqb_size+=HIF_SER_SIZEOF(2);            /* edd_type */
            rqb_size+=HIF_SER_SIZEOF(2);            /* asic_type */
            rqb_size+=HIF_SER_SIZEOF(2);            /* rev_nr */
            rqb_size+=HIF_SER_SIZEOF(1);            /* allow_none_pnio_mautypes */
            rqb_size+=HIF_SER_SIZEOF(2);            /* send_clock_factor */
            for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)            /* if_mac*/
            {
                rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);                /*  */
            }
            for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)            /* port_mac*/
            {
                rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);                /*  */
            }
        }
        for(i=0;i<ptr_rqb_src->args.ld_open.hd_count;i++)        /* hd_out*/
        {
            for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)            /* hw_port*/
            {
                rqb_size+=HIF_SER_SIZEOF(2);                /* media_type */
            }
            for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)            /* pnio_if*/
            {
                rqb_size+=HIF_SER_SIZEOF(2);                /* nr_of_usr_ports */
                rqb_size+=HIF_SER_SIZEOF(2);                /* ioc_max_devices */
                rqb_size+=HIF_SER_SIZEOF(2);                /* iom_max_devices */
                rqb_size+=HIF_SER_SIZEOF(2);                /* iod_max_devices */
                rqb_size+=HIF_SER_SIZEOF(2);                /* iod_max_ar */
                rqb_size+=HIF_SER_SIZEOF(2);                /* iod_max_ar_RT */
                rqb_size+=HIF_SER_SIZEOF(2);                /* iod_max_ar_IRT */
                rqb_size+=HIF_SER_SIZEOF(2);                /* iod_max_ar_DAC */
                rqb_size+=HIF_SER_SIZEOF(2);                /* iod_max_ar_IOS */
            }
        }
        HIF_ALLOC_SER_MEM((LSA_VOID**)(&help_ptr), rqb_size, hSysDev, hShmPool);
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_serialize_lower() opc(%d) rqb_size_shm(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,ptr_rqb_src);

        if (HIF_IS_NULL(help_ptr))
        {
            return HIF_ERR_RESOURCE;
        }

        *ptr_ptr_rqb_dest = help_ptr;
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,*((LSA_UINT32*)ptr_rqb_src-1));                /* original upper RQB pointer */

        HIF_SER_OPCODE_HTSHM((LSA_UINT32**)&help_ptr,opcode);                /* _opcode */
        HIF_SER_COMP_ID_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_COMP_ID(ptr_rqb_src));                /* _comp_id */
        HIF_SER_RESPONSE_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_RESPONSE(ptr_rqb_src));                /* _response */
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_count);                /* hd_count */
        for(i=0;i<ptr_rqb_src->args.ld_open.hd_count;i++)                                /* hd_args*/
        {
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_id);                        /* hd_id */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_selection);                        /* hd_selection */
            for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                    /* hd_location*/
            {
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_mac[j]);                        /* hd_mac */
            }
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_location.bus_nr);                        /* bus_nr */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_location.device_nr);                        /* device_nr */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].hd_location.hd_location.function_nr);                        /* function_nr */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].runs_on_level_basic);                        /* runs_on_level_basic */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].nr_of_ports);                        /* nr_of_ports */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].nr_of_all_ports);                        /* nr_of_all_ports */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].edd_type);                        /* edd_type */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].asic_type);                        /* asic_type */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].rev_nr);                        /* rev_nr */
            HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].allow_none_pnio_mautypes);                        /* allow_none_pnio_mautypes */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].send_clock_factor);                        /* send_clock_factor */
            for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)                                                /* if_mac*/
            {
                for(k=0;k<PSI_MAC_ADDR_SIZE;k++)                                                /* if_mac*/
                {
                    HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].if_mac[j][k]);                                /*  */
                }
            }
            for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)                                                /* port_mac*/
            {
                for(k=0;k<PSI_MAC_ADDR_SIZE;k++)                                                /* port_mac*/
                {
                    HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_args[i].port_mac[j][k]);                                /*  */
                }
            }
        }
        for(i=0;i<ptr_rqb_src->args.ld_open.hd_count;i++)                                /* hd_out*/
        {
            for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)                                                /* hw_port*/
            {
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].hw_port[j].media_type);                                /* media_type */
            }
            for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)                                                /* pnio_if*/
            {
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].nr_of_usr_ports);                                /* nr_of_usr_ports */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].ioc_max_devices);                                /* ioc_max_devices */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].iom_max_devices);                                /* iom_max_devices */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].iod_max_devices);                                /* iod_max_devices */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar);                                /* iod_max_ar */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar_RT);                                /* iod_max_ar_RT */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar_IRT);                                /* iod_max_ar_IRT */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar_DAC);                                /* iod_max_ar_DAC */
                HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar_IOS);                                /* iod_max_ar_IOS */
            }
        }

        /* Delete lower RQB after lower serialization */
        HIF_FREE_LOCAL_MEM(&freeRes,(LSA_UINT8*)ptr_rqb_src-HIF_SER_SIZEOF(4));
        if (freeRes != LSA_RET_OK)
        {
            return HIF_ERR_RESOURCE;
        }
    }
    else if (opcode==PSI_OPC_HD_OPEN_DEVICE)
    {
        rqb_size+=HIF_SER_SIZEOF(4);        /* original upper RQB pointer */
        rqb_size+=HIF_SER_SIZEOF_OPCODE_TYPE();        /* _opcode */
        rqb_size+=HIF_SER_SIZEOF_COMP_ID_TYPE();        /* _comp_id */
        rqb_size+=HIF_SER_SIZEOF_RESPONSE_TYPE();        /* _response */
        rqb_size+=HIF_SER_SIZEOF(2);        /* hd_id */
        rqb_size+=HIF_SER_SIZEOF(2);        /* hd_selection */
        rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);        /* hd_mac */
        rqb_size+=HIF_SER_SIZEOF(2);        /* bus_nr */
        rqb_size+=HIF_SER_SIZEOF(2);        /* device_nr */
        rqb_size+=HIF_SER_SIZEOF(2);        /* function_nr */
        rqb_size+=HIF_SER_SIZEOF(1);        /* runs_on_level_basic */
        rqb_size+=HIF_SER_SIZEOF(2);        /* nr_of_ports */
        rqb_size+=HIF_SER_SIZEOF(2);        /* nr_of_all_ports */
        rqb_size+=HIF_SER_SIZEOF(2);        /* edd_type */
        rqb_size+=HIF_SER_SIZEOF(2);        /* asic_type */
        rqb_size+=HIF_SER_SIZEOF(2);        /* rev_nr */
        rqb_size+=HIF_SER_SIZEOF(1);        /* allow_none_pnio_mautypes */
        rqb_size+=HIF_SER_SIZEOF(2);        /* send_clock_factor */
        for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)        /* if_mac*/
        {
            rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);            /*  */
        }
        for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)        /* port_mac*/
        {
            rqb_size+=(HIF_SER_SIZEOF(1) * PSI_MAC_ADDR_SIZE);            /*  */
        }
        for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)        /* hw_port*/
        {
            rqb_size+=HIF_SER_SIZEOF(2);            /* media_type */
        }
        for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)        /* pnio_if*/
        {
            rqb_size+=HIF_SER_SIZEOF(2);            /* nr_of_usr_ports */
            rqb_size+=HIF_SER_SIZEOF(2);            /* ioc_max_devices */
            rqb_size+=HIF_SER_SIZEOF(2);            /* iom_max_devices */
            rqb_size+=HIF_SER_SIZEOF(2);            /* iod_max_devices */
            rqb_size+=HIF_SER_SIZEOF(2);            /* iod_max_ar */
            rqb_size+=HIF_SER_SIZEOF(2);            /* iod_max_ar_RT */
            rqb_size+=HIF_SER_SIZEOF(2);            /* iod_max_ar_IRT */
            rqb_size+=HIF_SER_SIZEOF(2);            /* iod_max_ar_DAC */
            rqb_size+=HIF_SER_SIZEOF(2);            /* iod_max_ar_IOS */
        }
        HIF_ALLOC_SER_MEM((LSA_VOID**)(&help_ptr), rqb_size, hSysDev, hShmPool);
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_serialize_lower() opc(%d) rqb_size_shm(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,ptr_rqb_src);

        if (HIF_IS_NULL(help_ptr))
        {
            return HIF_ERR_RESOURCE;
        }

        *ptr_ptr_rqb_dest = help_ptr;
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,*((LSA_UINT32*)ptr_rqb_src-1));                /* original upper RQB pointer */

        HIF_SER_OPCODE_HTSHM((LSA_UINT32**)&help_ptr,opcode);                /* _opcode */
        HIF_SER_COMP_ID_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_COMP_ID(ptr_rqb_src));                /* _comp_id */
        HIF_SER_RESPONSE_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_RESPONSE(ptr_rqb_src));                /* _response */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_id);                /* hd_id */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_selection);                /* hd_selection */
        for(i=0;i<PSI_MAC_ADDR_SIZE;i++)                        /* hd_location*/
        {
            HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_mac[i]);                /* hd_mac */
        }
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_location.bus_nr);                /* bus_nr */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_location.device_nr);                /* device_nr */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.hd_location.hd_location.function_nr);                /* function_nr */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.runs_on_level_basic);                /* runs_on_level_basic */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.nr_of_ports);                /* nr_of_ports */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.nr_of_all_ports);                /* nr_of_all_ports */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.edd_type);                /* edd_type */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.asic_type);                /* asic_type */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.rev_nr);                /* rev_nr */
        HIF_SER_COPY_HTSHM_LSA_BOOL((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.allow_none_pnio_mautypes);                /* allow_none_pnio_mautypes */
        HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.send_clock_factor);                /* send_clock_factor */
        for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)                                /* if_mac*/
        {
            for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                    /* if_mac*/
            {
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.if_mac[i][j]);                        /*  */
            }
        }
        for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)                                /* port_mac*/
        {
            for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                    /* port_mac*/
            {
                HIF_SER_COPY_HTSHM_8((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_args.port_mac[i][j]);                        /*  */
            }
        }
        for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)                                /* hw_port*/
        {
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.hw_port[i].media_type);                        /* media_type */
        }
        for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)                                /* pnio_if*/
        {
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].nr_of_usr_ports);                        /* nr_of_usr_ports */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].ioc_max_devices);                        /* ioc_max_devices */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].iom_max_devices);                        /* iom_max_devices */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].iod_max_devices);                        /* iod_max_devices */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].iod_max_ar);                        /* iod_max_ar */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].iod_max_ar_RT);                        /* iod_max_ar_RT */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].iod_max_ar_IRT);                        /* iod_max_ar_IRT */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].iod_max_ar_DAC);                        /* iod_max_ar_DAC */
            HIF_SER_COPY_HTSHM_16((LSA_UINT32**)&help_ptr,ptr_rqb_src->args.hd_open.hd_out.pnio_if[i].iod_max_ar_IOS);                        /* iod_max_ar_IOS */
        }

        /* Delete lower RQB after lower serialization */
        HIF_FREE_LOCAL_MEM(&freeRes,(LSA_UINT8*)ptr_rqb_src-HIF_SER_SIZEOF(4));
        if (freeRes != LSA_RET_OK)
        {
            return HIF_ERR_RESOURCE;
        }
    }
    else if (opcode==PSI_OPC_LD_CLOSE_DEVICE)
    {
        rqb_size+=HIF_SER_SIZEOF(4);        /* original upper RQB pointer */
        rqb_size+=HIF_SER_SIZEOF_OPCODE_TYPE();        /* _opcode */
        rqb_size+=HIF_SER_SIZEOF_COMP_ID_TYPE();        /* _comp_id */
        rqb_size+=HIF_SER_SIZEOF_RESPONSE_TYPE();        /* _response */
        HIF_ALLOC_SER_MEM((LSA_VOID**)(&help_ptr), rqb_size, hSysDev, hShmPool);
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_serialize_lower() opc(%d) rqb_size_shm(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,ptr_rqb_src);

        if (HIF_IS_NULL(help_ptr))
        {
            return HIF_ERR_RESOURCE;
        }

        *ptr_ptr_rqb_dest = help_ptr;
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,*((LSA_UINT32*)ptr_rqb_src-1));                /* original upper RQB pointer */

        HIF_SER_OPCODE_HTSHM((LSA_UINT32**)&help_ptr,opcode);                /* _opcode */
        HIF_SER_COMP_ID_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_COMP_ID(ptr_rqb_src));                /* _comp_id */
        HIF_SER_RESPONSE_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_RESPONSE(ptr_rqb_src));                /* _response */

        /* Delete lower RQB after lower serialization */
        HIF_FREE_LOCAL_MEM(&freeRes,(LSA_UINT8*)ptr_rqb_src-HIF_SER_SIZEOF(4));
        if (freeRes != LSA_RET_OK)
        {
            return HIF_ERR_RESOURCE;
        }
    }
    else if (opcode==PSI_OPC_HD_CLOSE_DEVICE)
    {
        rqb_size+=HIF_SER_SIZEOF(4);        /* original upper RQB pointer */
        rqb_size+=HIF_SER_SIZEOF_OPCODE_TYPE();        /* _opcode */
        rqb_size+=HIF_SER_SIZEOF_COMP_ID_TYPE();        /* _comp_id */
        rqb_size+=HIF_SER_SIZEOF_RESPONSE_TYPE();        /* _response */
        HIF_ALLOC_SER_MEM((LSA_VOID**)(&help_ptr), rqb_size, hSysDev, hShmPool);
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_serialize_lower() opc(%d) rqb_size_shm(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,ptr_rqb_src);

        if (HIF_IS_NULL(help_ptr))
        {
            return HIF_ERR_RESOURCE;
        }

        *ptr_ptr_rqb_dest = help_ptr;
        HIF_SER_COPY_HTSHM_32((LSA_UINT32**)&help_ptr,*((LSA_UINT32*)ptr_rqb_src-1));                /* original upper RQB pointer */

        HIF_SER_OPCODE_HTSHM((LSA_UINT32**)&help_ptr,opcode);                /* _opcode */
        HIF_SER_COMP_ID_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_COMP_ID(ptr_rqb_src));                /* _comp_id */
        HIF_SER_RESPONSE_HTSHM((LSA_UINT32**)&help_ptr,HIF_RQB_GET_RESPONSE(ptr_rqb_src));                /* _response */

        /* Delete lower RQB after lower serialization */
        HIF_FREE_LOCAL_MEM(&freeRes,(LSA_UINT8*)ptr_rqb_src-HIF_SER_SIZEOF(4));
        if (freeRes != LSA_RET_OK)
        {
            return HIF_ERR_RESOURCE;
        }
    }
    else
    {
        HIF_PROGRAM_TRACE_02(0,LSA_TRACE_LEVEL_FATAL,"hif_psi_serialize_lower(). RQB-Opcode:0x%x is not valid! pRQB(0x%08x)",opcode,ptr_rqb_src+4);
        HIF_FATAL(0);
    }

    *pSerRqbLen = rqb_size;

    HIF_ASSERT(HIF_IS_NOT_NULL(help_ptr)); /*#4*/

    /* Check for overwrite */
    HIF_SHM_CHECK_OVERWRITE_SERIALIZE(opcode, *ptr_ptr_rqb_dest, rqb_size, help_ptr, "hif_psi_serialize_lower");

    return HIF_OK;
}

/****************************************************************************
*  Name:        hif_psi_deserialize_upper()
*  Purpose:     De-serializes the RQB from the HIF shared memory into the
*               hosts local memory - according to the component ID and
*               OP-code in the RQB.
*  Input:       pRqbSrc - pointer to the RQB in shared memory
                pPipe   - pointer to pipe management structure
*  Output:      ppRqbDest - pointer to the RQB in the hosts local memory
*  Return:      HIF_OK
*               HIF_ERR_RESOURCE
****************************************************************************/
LSA_UINT16      hif_psi_deserialize_upper (
        HIF_SYS_HANDLE hSysDev,
        LSA_VOID* pHifPipeHandle,
        LSA_VOID* pRqbSrc,
        LSA_VOID** ppRqbDest )
{
    LSA_UINT8* help_ptr = LSA_NULL;
    LSA_OPCODE_TYPE opcode = 0;
    LSA_VOID* ptr_rqb_src = (LSA_VOID*)pRqbSrc;
    PSI_RQB_TYPE** ptr_ptr_rqb_dest = (PSI_RQB_TYPE**)ppRqbDest;
    LSA_COMP_ID_TYPE comp_id = 0;
    LSA_RESPONSE_TYPE response = 0;
    PSI_RQB_TYPE* new_rqb  = LSA_NULL;
    LSA_UINT32 i=0,j=0,k=0;

    HIF_ASSERT(HIF_IS_NOT_NULL(ptr_ptr_rqb_dest)); /*#17*/
    HIF_DESER_GET_OPCODE(ptr_rqb_src, opcode);

    LSA_UNUSED_ARG(hSysDev);
    LSA_UNUSED_ARG(pHifPipeHandle);

    if (opcode==PSI_OPC_LD_OPEN_DEVICE)
    {
        help_ptr = (LSA_UINT8*)ptr_rqb_src + HIF_SER_SIZEOF(4);        /* start deserialization after the original upper RQB pointer */

        if (HIF_IS_NULL((LSA_UINT8*)ptr_rqb_src))
        {
            return HIF_ERR_RESOURCE;
        }
        else
        {
            new_rqb = (PSI_RQB_TYPE*)hif_get_rqb_id(ptr_rqb_src); /* get orig. upper RQB */
            HIF_PROGRAM_TRACE_03(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_deserialize_upper() opc(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,ptr_rqb_src,new_rqb+4);
            *ptr_ptr_rqb_dest = new_rqb;

            /* restore the Upper RQB */
            HIF_RQB_SET_OPCODE(new_rqb,opcode);                        /* _opcode */
            help_ptr+=4;                        /* skip opcode on shared-mem */
            HIF_SER_COMP_ID_SHMTH(&comp_id,(LSA_UINT32**)&help_ptr);                        /* _comp_id */
            HIF_RQB_SET_COMP_ID(new_rqb,comp_id);                                                 /* _comp_id */
            HIF_SER_RESPONSE_SHMTH(&response,(LSA_UINT32**)&help_ptr);                        /* _response */
            HIF_RQB_SET_RESPONSE(new_rqb,response);                                                /* _response */
            HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.hd_count,(LSA_UINT32**)&help_ptr);            /* hd_count */
            for(i=0;i<new_rqb->args.ld_open.hd_count;i++)                                    /* hd_args*/
            {
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hd_id,(LSA_UINT32**)&help_ptr);                /* hd_id */
                HIF_SER_COPY_SHMTH_16((PSI_HD_SELECT_TYPE*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_selection,(LSA_UINT32**)&help_ptr);                /* hd_selection */
                for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                                /* hd_mac*/
                {
                    HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_mac[j],(LSA_UINT32**)&help_ptr);                /* hd_mac */
                }
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_location.bus_nr,(LSA_UINT32**)&help_ptr);                /* bus_nr */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_location.device_nr,(LSA_UINT32**)&help_ptr);                /* device_nr */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_location.function_nr,(LSA_UINT32**)&help_ptr);                /* function_nr */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].runs_on_level_basic,(LSA_UINT32**)&help_ptr);                /* runs_on_level_basic */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].nr_of_ports,(LSA_UINT32**)&help_ptr);                /* nr_of_ports */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].nr_of_all_ports,(LSA_UINT32**)&help_ptr);                /* nr_of_all_ports */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].edd_type,(LSA_UINT32**)&help_ptr);                /* edd_type */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].asic_type,(LSA_UINT32**)&help_ptr);                /* asic_type */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].rev_nr,(LSA_UINT32**)&help_ptr);                /* rev_nr */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].allow_none_pnio_mautypes,(LSA_UINT32**)&help_ptr);                /* allow_none_pnio_mautypes */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].send_clock_factor,(LSA_UINT32**)&help_ptr);                /* send_clock_factor */
                for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)                                                /* if_mac*/
                {
                    for(k=0;k<PSI_MAC_ADDR_SIZE;k++)                                                            /* */
                    {
                        HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.ld_open.hd_args[i].if_mac[j][k],(LSA_UINT32**)&help_ptr);                    /*  */
                    }
                }
                for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)                                                /* port_mac*/
                {
                    for(k=0;k<PSI_MAC_ADDR_SIZE;k++)                                                            /* */
                    {
                        HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.ld_open.hd_args[i].port_mac[j][k],(LSA_UINT32**)&help_ptr);                    /*  */
                    }
                }
            }
            for(i=0;i<new_rqb->args.ld_open.hd_count;i++)                                    /* hd_out*/
            {
                for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)                                                /* hw_port*/
                {
                    HIF_SER_COPY_SHMTH_16((PSI_PORT_MEDIA_TYPE*)&new_rqb->args.ld_open.hd_out[i].hw_port[j].media_type,(LSA_UINT32**)&help_ptr);                    /* media_type */
                }
                for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)                                                /* pnio_if*/
                {
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].nr_of_usr_ports,(LSA_UINT32**)&help_ptr);                    /* nr_of_usr_ports */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].ioc_max_devices,(LSA_UINT32**)&help_ptr);                    /* ioc_max_devices */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].iom_max_devices,(LSA_UINT32**)&help_ptr);                    /* iom_max_devices */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].iod_max_devices,(LSA_UINT32**)&help_ptr);                    /* iod_max_devices */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar,(LSA_UINT32**)&help_ptr);                    /* iod_max_ar */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar_RT,(LSA_UINT32**)&help_ptr);                    /* iod_max_ar_RT */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar_IRT,(LSA_UINT32**)&help_ptr);                    /* iod_max_ar_IRT */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar_DAC,(LSA_UINT32**)&help_ptr);                    /* iod_max_ar_DAC */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_out[i].pnio_if[j].iod_max_ar_IOS,(LSA_UINT32**)&help_ptr);                    /* iod_max_ar_IOS */
                }
            }
        }
    }
    else if (opcode==PSI_OPC_HD_OPEN_DEVICE)
    {
        help_ptr = (LSA_UINT8*)ptr_rqb_src + HIF_SER_SIZEOF(4);        /* start deserialization after the original upper RQB pointer */

        if (HIF_IS_NULL((LSA_UINT8*)ptr_rqb_src))
        {
            return HIF_ERR_RESOURCE;
        }
        else
        {
            new_rqb = (PSI_RQB_TYPE*)hif_get_rqb_id(ptr_rqb_src); /* get orig. upper RQB */
            HIF_PROGRAM_TRACE_03(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_deserialize_upper() opc(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,ptr_rqb_src,new_rqb+4);
            *ptr_ptr_rqb_dest = new_rqb;

            /* restore the Upper RQB */
            HIF_RQB_SET_OPCODE(new_rqb,opcode);                        /* _opcode */
            help_ptr+=4;                        /* skip opcode on shared-mem */
            HIF_SER_COMP_ID_SHMTH(&comp_id,(LSA_UINT32**)&help_ptr);                        /* _comp_id */
            HIF_RQB_SET_COMP_ID(new_rqb,comp_id);                                                 /* _comp_id */
            HIF_SER_RESPONSE_SHMTH(&response,(LSA_UINT32**)&help_ptr);                        /* _response */
            HIF_RQB_SET_RESPONSE(new_rqb,response);                                                /* _response */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hd_id,(LSA_UINT32**)&help_ptr);            /* hd_id */
            HIF_SER_COPY_SHMTH_16((PSI_HD_SELECT_TYPE*)&new_rqb->args.hd_open.hd_args.hd_location.hd_selection,(LSA_UINT32**)&help_ptr);            /* hd_selection */
            for(i=0;i<PSI_MAC_ADDR_SIZE;i++)                                    /* hd_mac*/
            {
                HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.hd_open.hd_args.hd_location.hd_mac[i],(LSA_UINT32**)&help_ptr);            /* hd_mac */
            }
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hd_location.hd_location.bus_nr,(LSA_UINT32**)&help_ptr);            /* bus_nr */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hd_location.hd_location.device_nr,(LSA_UINT32**)&help_ptr);            /* device_nr */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hd_location.hd_location.function_nr,(LSA_UINT32**)&help_ptr);            /* function_nr */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.runs_on_level_basic,(LSA_UINT32**)&help_ptr);            /* runs_on_level_basic */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.nr_of_ports,(LSA_UINT32**)&help_ptr);            /* nr_of_ports */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.nr_of_all_ports,(LSA_UINT32**)&help_ptr);            /* nr_of_all_ports */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.edd_type,(LSA_UINT32**)&help_ptr);            /* edd_type */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.asic_type,(LSA_UINT32**)&help_ptr);            /* asic_type */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.rev_nr,(LSA_UINT32**)&help_ptr);            /* rev_nr */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.allow_none_pnio_mautypes,(LSA_UINT32**)&help_ptr);            /* allow_none_pnio_mautypes */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.send_clock_factor,(LSA_UINT32**)&help_ptr);            /* send_clock_factor */
            for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)                                    /* if_mac*/
            {
                for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                                /* */
                {
                    HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.hd_open.hd_args.if_mac[i][j],(LSA_UINT32**)&help_ptr);                /*  */
                }
            }
            for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)                                    /* port_mac*/
            {
                for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                                /* */
                {
                    HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.hd_open.hd_args.port_mac[i][j],(LSA_UINT32**)&help_ptr);                /*  */
                }
            }
            for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)                                    /* hw_port*/
            {
                HIF_SER_COPY_SHMTH_16((PSI_PORT_MEDIA_TYPE*)&new_rqb->args.hd_open.hd_out.hw_port[i].media_type,(LSA_UINT32**)&help_ptr);                /* media_type */
            }
            for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)                                    /* pnio_if*/
            {
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].nr_of_usr_ports,(LSA_UINT32**)&help_ptr);                /* nr_of_usr_ports */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].ioc_max_devices,(LSA_UINT32**)&help_ptr);                /* ioc_max_devices */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].iom_max_devices,(LSA_UINT32**)&help_ptr);                /* iom_max_devices */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].iod_max_devices,(LSA_UINT32**)&help_ptr);                /* iod_max_devices */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].iod_max_ar,(LSA_UINT32**)&help_ptr);                /* iod_max_ar */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].iod_max_ar_RT,(LSA_UINT32**)&help_ptr);                /* iod_max_ar_RT */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].iod_max_ar_IRT,(LSA_UINT32**)&help_ptr);                /* iod_max_ar_IRT */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].iod_max_ar_DAC,(LSA_UINT32**)&help_ptr);                /* iod_max_ar_DAC */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_out.pnio_if[i].iod_max_ar_IOS,(LSA_UINT32**)&help_ptr);                /* iod_max_ar_IOS */
            }
        }
    }
    else if (opcode==PSI_OPC_LD_CLOSE_DEVICE)
    {
        help_ptr = (LSA_UINT8*)ptr_rqb_src + HIF_SER_SIZEOF(4);        /* start deserialization after the original upper RQB pointer */

        if (HIF_IS_NULL((LSA_UINT8*)ptr_rqb_src))
        {
            return HIF_ERR_RESOURCE;
        }
        else
        {
            new_rqb = (PSI_RQB_TYPE*)hif_get_rqb_id(ptr_rqb_src); /* get orig. upper RQB */
            HIF_PROGRAM_TRACE_03(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_deserialize_upper() opc(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,ptr_rqb_src,new_rqb+4);
            *ptr_ptr_rqb_dest = new_rqb;

            /* restore the Upper RQB */
            HIF_RQB_SET_OPCODE(new_rqb,opcode);                        /* _opcode */
            help_ptr+=4;                        /* skip opcode on shared-mem */
            HIF_SER_COMP_ID_SHMTH(&comp_id,(LSA_UINT32**)&help_ptr);                        /* _comp_id */
            HIF_RQB_SET_COMP_ID(new_rqb,comp_id);                                                 /* _comp_id */
            HIF_SER_RESPONSE_SHMTH(&response,(LSA_UINT32**)&help_ptr);                        /* _response */
            HIF_RQB_SET_RESPONSE(new_rqb,response);                                                /* _response */
        }
    }
    else if (opcode==PSI_OPC_HD_CLOSE_DEVICE)
    {
        help_ptr = (LSA_UINT8*)ptr_rqb_src + HIF_SER_SIZEOF(4);        /* start deserialization after the original upper RQB pointer */

        if (HIF_IS_NULL((LSA_UINT8*)ptr_rqb_src))
        {
            return HIF_ERR_RESOURCE;
        }
        else
        {
            new_rqb = (PSI_RQB_TYPE*)hif_get_rqb_id(ptr_rqb_src); /* get orig. upper RQB */
            HIF_PROGRAM_TRACE_03(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_deserialize_upper() opc(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,ptr_rqb_src,new_rqb+4);
            *ptr_ptr_rqb_dest = new_rqb;

            /* restore the Upper RQB */
            HIF_RQB_SET_OPCODE(new_rqb,opcode);                        /* _opcode */
            help_ptr+=4;                        /* skip opcode on shared-mem */
            HIF_SER_COMP_ID_SHMTH(&comp_id,(LSA_UINT32**)&help_ptr);                        /* _comp_id */
            HIF_RQB_SET_COMP_ID(new_rqb,comp_id);                                                 /* _comp_id */
            HIF_SER_RESPONSE_SHMTH(&response,(LSA_UINT32**)&help_ptr);                        /* _response */
            HIF_RQB_SET_RESPONSE(new_rqb,response);                                                /* _response */
        }
    }
    else
    {
        HIF_PROGRAM_TRACE_03(0,LSA_TRACE_LEVEL_FATAL,"hif_psi_deserialize_upper(). RQB-Opcode:0x%x is not valid! shm_addr(0x%08x) pRQB(0x%08x)", opcode, ptr_rqb_src, new_rqb+4);
        HIF_FATAL(0);
    }
    HIF_ASSERT(HIF_IS_NOT_NULL(new_rqb)); /*#16*/
    *ptr_ptr_rqb_dest = new_rqb;

    /* Check for overwrite */
    HIF_SHM_CHECK_OVERWRITE_DESERIALIZE(ptr_rqb_src, opcode, help_ptr, "hif_psi_deserialize_upper");

    return HIF_OK;
}

/****************************************************************************
*  Name:        hif_psi_deserialize_lower()
*  Purpose:     De-serializes the RQB from the HIF shared memory into the
*               hosts local memory - according to the component ID and
*               OP-code in the RQB.
*  Input:       pRqbSrc - pointer to the RQB in shared memory
                pPipe   - pointer to pipe management structure
*  Output:      ppRqbDest - pointer to the RQB in the hosts local memory
*  Return:      HIF_OK
*               HIF_ERR_RESOURCE
****************************************************************************/
LSA_UINT16      hif_psi_deserialize_lower (
        HIF_SYS_HANDLE hSysDev,
        LSA_VOID* pHifPipeHandle,
        LSA_VOID* pRqbSrc,
        LSA_VOID** ppRqbDest )
{
    LSA_UINT8* help_ptr = LSA_NULL;
    LSA_OPCODE_TYPE opcode = 0;
    LSA_VOID* ptr_rqb_src = (LSA_VOID*)pRqbSrc;
    PSI_RQB_TYPE** ptr_ptr_rqb_dest = (PSI_RQB_TYPE**)ppRqbDest;
    LSA_COMP_ID_TYPE comp_id = 0;
    PSI_RQB_TYPE* new_rqb  = LSA_NULL;
    LSA_UINT32 rqb_size = 0;
    LSA_UINT32 i=0,j=0,k=0;

    HIF_ASSERT(HIF_IS_NOT_NULL(ptr_ptr_rqb_dest)); /*#17*/
    HIF_DESER_GET_OPCODE(ptr_rqb_src, opcode);

    LSA_UNUSED_ARG(hSysDev);
    LSA_UNUSED_ARG(pHifPipeHandle);

    if (opcode==PSI_OPC_LD_OPEN_DEVICE)
    {
        /* calculate rqb-size */
        rqb_size=sizeof(PSI_RQB_TYPE) + HIF_SER_SIZEOF(4);        /* RQB-size + original upper RQB pointer */
        help_ptr = (LSA_UINT8*)ptr_rqb_src;

        HIF_ALLOC_LOCAL_MEM(((LSA_VOID**)(&new_rqb)), rqb_size );
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_deserialize_lower() opc(%d) rqb_size(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,new_rqb+4);
        if (HIF_IS_NULL(new_rqb))
        {
            return HIF_ERR_RESOURCE;
        }
        else
        {
            HIF_SER_COPY_SHMTH_32((LSA_UINT32*)new_rqb,(LSA_UINT32**)&help_ptr);            /* orig. upper RQB pointer */
            new_rqb=(PSI_RQB_TYPE*)((LSA_UINT8*)new_rqb+HIF_SER_SIZEOF(4));                                     /* real lower rqb src without orig. upper RQB pointer */
            *ptr_ptr_rqb_dest = new_rqb;                                    /* return real lower rqb src without orig. upper RQB pointer */

            /* restore Lower RQB */
            HIF_RQB_SET_OPCODE(new_rqb,opcode);                        /* _opcode */
            help_ptr+=4;                        /* skip opcode on shared-mem */
            HIF_SER_COMP_ID_SHMTH(&comp_id,(LSA_UINT32**)&help_ptr);                        /* _comp_id */
            HIF_RQB_SET_COMP_ID(new_rqb,comp_id);                                                 /* _comp_id */
            /* INFO: deserialize the array size from right after the pointer */
            HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.hd_count,(LSA_UINT32**)&help_ptr);            /* hd_count */
            for(i=0;i<PSI_CFG_MAX_SOCK_APP_CHANNELS;i++)                                    /* sock_app_ch_details*/
            {
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].use_settings,(LSA_UINT32**)&help_ptr);                /* use_settings */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_REUSEADDR_,(LSA_UINT32**)&help_ptr);                /* SO_REUSEADDR_ */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_DONTROUTE_,(LSA_UINT32**)&help_ptr);                /* SO_DONTROUTE_ */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_SNDBUF_,(LSA_UINT32**)&help_ptr);                /* SO_SNDBUF_ */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_RCVBUF_,(LSA_UINT32**)&help_ptr);                /* SO_RCVBUF_ */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_LINGER_,(LSA_UINT32**)&help_ptr);                /* SO_LINGER_ */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_TCPNODELAY_,(LSA_UINT32**)&help_ptr);                /* SO_TCPNODELAY_ */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.socket_option.SO_TCPNOACKDELAY_,(LSA_UINT32**)&help_ptr);                /* SO_TCPNOACKDELAY_ */
                HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.send_buffer_max_len,(LSA_UINT32**)&help_ptr);                /* send_buffer_max_len */
                HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.rec_buffer_max_len,(LSA_UINT32**)&help_ptr);                /* rec_buffer_max_len */
                HIF_SER_COPY_SHMTH_16((LSA_INT16*)&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.sock_close_at_once,(LSA_UINT32**)&help_ptr);                /* sock_close_at_once */
                HIF_SER_COPY_SHMTH_16((LSA_INT16*)&new_rqb->args.ld_open.sock_args.sock_app_ch_details[i].sock_detail.linger_time,(LSA_UINT32**)&help_ptr);                /* linger_time */
            }
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.im_args.vendor_id_high,(LSA_UINT32**)&help_ptr);            /* vendor_id_high */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.im_args.vendor_id_low,(LSA_UINT32**)&help_ptr);            /* vendor_id_low */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.im_args.hw_revision,(LSA_UINT32**)&help_ptr);            /* hw_revision */
            HIF_SER_COPY_SHMTH_8(&new_rqb->args.ld_open.im_args.sw_version.revision_prefix,(LSA_UINT32**)&help_ptr);            /* revision_prefix */
            HIF_SER_COPY_SHMTH_8(&new_rqb->args.ld_open.im_args.sw_version.functional_enhancement,(LSA_UINT32**)&help_ptr);            /* functional_enhancement */
            HIF_SER_COPY_SHMTH_8(&new_rqb->args.ld_open.im_args.sw_version.bug_fix,(LSA_UINT32**)&help_ptr);            /* bug_fix */
            HIF_SER_COPY_SHMTH_8(&new_rqb->args.ld_open.im_args.sw_version.internal_change,(LSA_UINT32**)&help_ptr);            /* internal_change */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.im_args.revision_counter,(LSA_UINT32**)&help_ptr);            /* revision_counter */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.im_args.profile_id,(LSA_UINT32**)&help_ptr);            /* profile_id */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.im_args.profile_specific_type,(LSA_UINT32**)&help_ptr);            /* profile_specific_type */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.im_args.version,(LSA_UINT32**)&help_ptr);            /* version */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.im_args.supported,(LSA_UINT32**)&help_ptr);            /* supported */
            for(i=0;i<PSI_MAX_SIZE_IM_ORDER_ID;i++)                                    /* order_id*/
            {
                HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.ld_open.im_args.order_id[i],(LSA_UINT32**)&help_ptr);            /* order_id */
            }
            for(i=0;i<PSI_MAX_SIZE_IM_DEVICE_TYPE;i++)                                    /* device_type*/
            {
                HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.ld_open.im_args.device_type[i],(LSA_UINT32**)&help_ptr);            /* device_type */
            }
            for(i=0;i<new_rqb->args.ld_open.hd_count;i++)                                    /* hd_args*/
            {
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hd_id,(LSA_UINT32**)&help_ptr);                /* hd_id */
                HIF_SER_COPY_SHMTH_16((PSI_HD_SELECT_TYPE*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_selection,(LSA_UINT32**)&help_ptr);                /* hd_selection */
                for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                                /* hd_mac*/
                {
                    HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_mac[j],(LSA_UINT32**)&help_ptr);                /* hd_mac */
                }
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_location.bus_nr,(LSA_UINT32**)&help_ptr);                /* bus_nr */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_location.device_nr,(LSA_UINT32**)&help_ptr);                /* device_nr */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hd_location.hd_location.function_nr,(LSA_UINT32**)&help_ptr);                /* function_nr */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].runs_on_level_basic,(LSA_UINT32**)&help_ptr);                /* runs_on_level_basic */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].nr_of_ports,(LSA_UINT32**)&help_ptr);                /* nr_of_ports */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].nr_of_if,(LSA_UINT32**)&help_ptr);                /* nr_of_if */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].nr_of_all_ports,(LSA_UINT32**)&help_ptr);                /* nr_of_all_ports */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].nr_of_all_if,(LSA_UINT32**)&help_ptr);                /* nr_of_all_if */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].edd_type,(LSA_UINT32**)&help_ptr);                /* edd_type */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].asic_type,(LSA_UINT32**)&help_ptr);                /* asic_type */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].rev_nr,(LSA_UINT32**)&help_ptr);                /* rev_nr */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].allow_none_pnio_mautypes,(LSA_UINT32**)&help_ptr);                /* allow_none_pnio_mautypes */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].send_clock_factor,(LSA_UINT32**)&help_ptr);                /* send_clock_factor */
                for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)                                                /* if_mac*/
                {
                    for(k=0;k<PSI_MAC_ADDR_SIZE;k++)                                                            /* */
                    {
                        HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.ld_open.hd_args[i].if_mac[j][k],(LSA_UINT32**)&help_ptr);                    /*  */
                    }
                }
                for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)                                                /* port_mac*/
                {
                    for(k=0;k<PSI_MAC_ADDR_SIZE;k++)                                                            /* */
                    {
                        HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.ld_open.hd_args[i].port_mac[j][k],(LSA_UINT32**)&help_ptr);                    /*  */
                    }
                }
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].irte.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].irte.irt_supported,(LSA_UINT32**)&help_ptr);                /* irt_supported */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].irte.nr_irt_forwarder,(LSA_UINT32**)&help_ptr);                /* nr_irt_forwarder */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].irte.reserved_ram_for_time,(LSA_UINT32**)&help_ptr);                /* reserved_ram_for_time */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].irte.support_irt_flex,(LSA_UINT32**)&help_ptr);                /* support_irt_flex */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].irte.disable_max_port_delay_check,(LSA_UINT32**)&help_ptr);                /* disable_max_port_delay_check */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnip.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnip.k32fw_trace_level,(LSA_UINT32**)&help_ptr);                /* k32fw_trace_level */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].stdmac.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].stdmac.gigabit_support,(LSA_UINT32**)&help_ptr);                /* gigabit_support */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].stdmac.nrt_copy_interface,(LSA_UINT32**)&help_ptr);                /* nrt_copy_interface */
                for(j=0;j<PSI_CFG_MAX_PORT_CNT;j++)                                                /* hw_port*/
                {
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hw_port[j].if_nr,(LSA_UINT32**)&help_ptr);                    /* if_nr */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].hw_port[j].user_nr,(LSA_UINT32**)&help_ptr);                    /* user_nr */
                    HIF_SER_COPY_SHMTH_16((PSI_RINGPORT_TYPE*)&new_rqb->args.ld_open.hd_args[i].hw_port[j].mrp_ringport_type,(LSA_UINT32**)&help_ptr);                    /* mrp_ringport_type */
                }
                for(j=0;j<PSI_CFG_MAX_HD_IF_CNT;j++)                                                /* pnio_if*/
                {
                    HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].if_id,(LSA_UINT32**)&help_ptr);                    /* if_id */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].edd_if_id,(LSA_UINT32**)&help_ptr);                    /* edd_if_id */
                    HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].trace_idx,(LSA_UINT32**)&help_ptr);                    /* trace_idx */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.use_setting,(LSA_UINT32**)&help_ptr);                    /* use_setting */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_rt_devices,(LSA_UINT32**)&help_ptr);                    /* nr_of_rt_devices */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_irt_devices,(LSA_UINT32**)&help_ptr);                    /* nr_of_irt_devices */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_qv_provider,(LSA_UINT32**)&help_ptr);                    /* nr_of_qv_provider */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_qv_consumer,(LSA_UINT32**)&help_ptr);                    /* nr_of_qv_consumer */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.logical_addr_space,(LSA_UINT32**)&help_ptr);                    /* logical_addr_space */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.nr_of_submod,(LSA_UINT32**)&help_ptr);                    /* nr_of_submod */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.max_iocr_data_size,(LSA_UINT32**)&help_ptr);                    /* max_iocr_data_size */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.max_mcr_data_size,(LSA_UINT32**)&help_ptr);                    /* max_mcr_data_size */
                    HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.max_record_length,(LSA_UINT32**)&help_ptr);                    /* max_record_length */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.max_alarm_data_length,(LSA_UINT32**)&help_ptr);                    /* max_alarm_data_length */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ioc.max_read_implicit,(LSA_UINT32**)&help_ptr);                    /* max_read_implicit */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.use_setting,(LSA_UINT32**)&help_ptr);                    /* use_setting */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.nr_of_instances,(LSA_UINT32**)&help_ptr);                    /* nr_of_instances */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.nr_of_ar,(LSA_UINT32**)&help_ptr);                    /* nr_of_ar */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.max_icr_data_size,(LSA_UINT32**)&help_ptr);                    /* max_icr_data_size */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.max_ocr_data_size,(LSA_UINT32**)&help_ptr);                    /* max_ocr_data_size */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.max_mcr_data_size,(LSA_UINT32**)&help_ptr);                    /* max_mcr_data_size */
                    HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.max_record_length,(LSA_UINT32**)&help_ptr);                    /* max_record_length */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.max_alarm_data_length,(LSA_UINT32**)&help_ptr);                    /* max_alarm_data_length */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].iod.nr_of_read_implicit,(LSA_UINT32**)&help_ptr);                    /* nr_of_read_implicit */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].cba.use_setting,(LSA_UINT32**)&help_ptr);                    /* use_setting */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].cba.nr_of_provider_con,(LSA_UINT32**)&help_ptr);                    /* nr_of_provider_con */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].cba.nr_of_consumer_con,(LSA_UINT32**)&help_ptr);                    /* nr_of_consumer_con */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].cba.nr_of_rt_provider,(LSA_UINT32**)&help_ptr);                    /* nr_of_rt_provider */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].cba.nr_of_rt_consumer,(LSA_UINT32**)&help_ptr);                    /* nr_of_rt_consumer */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].cba.data_volume_size,(LSA_UINT32**)&help_ptr);                    /* data_volume_size */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ip.use_setting,(LSA_UINT32**)&help_ptr);                    /* use_setting */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_send,(LSA_UINT32**)&help_ptr);                    /* nr_of_send */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_arp,(LSA_UINT32**)&help_ptr);                    /* nr_of_arp */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_icmp,(LSA_UINT32**)&help_ptr);                    /* nr_of_icmp */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_udp,(LSA_UINT32**)&help_ptr);                    /* nr_of_udp */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ip.nr_of_tcp ,(LSA_UINT32**)&help_ptr);                    /* nr_of_tcp  */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].ip.multicast_support_on,(LSA_UINT32**)&help_ptr);                    /* multicast_support_on */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].oha.use_setting,(LSA_UINT32**)&help_ptr);                    /* use_setting */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].oha.vendor_id,(LSA_UINT32**)&help_ptr);                    /* vendor_id */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].oha.device_id,(LSA_UINT32**)&help_ptr);                    /* device_id */
                    HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].oha.instance_opt,(LSA_UINT32**)&help_ptr);                    /* instance_opt */
                    HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].oha.check_interval,(LSA_UINT32**)&help_ptr);                    /* check_interval */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].oha.check_ip_enabled,(LSA_UINT32**)&help_ptr);                    /* check_ip_enabled */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].oha.nos_allow_upper_cases,(LSA_UINT32**)&help_ptr);                    /* nos_allow_upper_cases */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].mrp.use_setting,(LSA_UINT32**)&help_ptr);                    /* use_setting */
                    HIF_SER_COPY_SHMTH_8(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].mrp.max_instances,(LSA_UINT32**)&help_ptr);                    /* max_instances */
                    HIF_SER_COPY_SHMTH_8(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].mrp.supported_role,(LSA_UINT32**)&help_ptr);                    /* supported_role */
                    HIF_SER_COPY_SHMTH_8(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].mrp.supported_multiple_role,(LSA_UINT32**)&help_ptr);                    /* supported_multiple_role */
                    HIF_SER_COPY_SHMTH_16((PSI_MRP_ROLE_TYPE*)&new_rqb->args.ld_open.hd_args[i].pnio_if[j].mrp.default_role_instance0,(LSA_UINT32**)&help_ptr);                    /* default_role_instance0 */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].nrt.RxFilterUDP_Unicast,(LSA_UINT32**)&help_ptr);                    /* RxFilterUDP_Unicast */
                    HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.ld_open.hd_args[i].pnio_if[j].nrt.RxFilterUDP_Broadcast,(LSA_UINT32**)&help_ptr);                    /* RxFilterUDP_Broadcast */
                }
            }
        }
    }
    else if (opcode==PSI_OPC_HD_OPEN_DEVICE)
    {
        /* calculate rqb-size */
        rqb_size=sizeof(PSI_RQB_TYPE) + HIF_SER_SIZEOF(4);        /* RQB-size + original upper RQB pointer */
        help_ptr = (LSA_UINT8*)ptr_rqb_src;

        HIF_ALLOC_LOCAL_MEM(((LSA_VOID**)(&new_rqb)), rqb_size );
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_deserialize_lower() opc(%d) rqb_size(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,new_rqb+4);
        if (HIF_IS_NULL(new_rqb))
        {
            return HIF_ERR_RESOURCE;
        }
        else
        {
            HIF_SER_COPY_SHMTH_32((LSA_UINT32*)new_rqb,(LSA_UINT32**)&help_ptr);            /* orig. upper RQB pointer */
            new_rqb=(PSI_RQB_TYPE*)((LSA_UINT8*)new_rqb+HIF_SER_SIZEOF(4));                                     /* real lower rqb src without orig. upper RQB pointer */
            *ptr_ptr_rqb_dest = new_rqb;                                    /* return real lower rqb src without orig. upper RQB pointer */

            /* restore Lower RQB */
            HIF_RQB_SET_OPCODE(new_rqb,opcode);                        /* _opcode */
            help_ptr+=4;                        /* skip opcode on shared-mem */
            HIF_SER_COMP_ID_SHMTH(&comp_id,(LSA_UINT32**)&help_ptr);                        /* _comp_id */
            HIF_RQB_SET_COMP_ID(new_rqb,comp_id);                                                 /* _comp_id */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hd_id,(LSA_UINT32**)&help_ptr);            /* hd_id */
            HIF_SER_COPY_SHMTH_16((PSI_HD_SELECT_TYPE*)&new_rqb->args.hd_open.hd_args.hd_location.hd_selection,(LSA_UINT32**)&help_ptr);            /* hd_selection */
            for(i=0;i<PSI_MAC_ADDR_SIZE;i++)                                    /* hd_mac*/
            {
                HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.hd_open.hd_args.hd_location.hd_mac[i],(LSA_UINT32**)&help_ptr);            /* hd_mac */
            }
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hd_location.hd_location.bus_nr,(LSA_UINT32**)&help_ptr);            /* bus_nr */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hd_location.hd_location.device_nr,(LSA_UINT32**)&help_ptr);            /* device_nr */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hd_location.hd_location.function_nr,(LSA_UINT32**)&help_ptr);            /* function_nr */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.runs_on_level_basic,(LSA_UINT32**)&help_ptr);            /* runs_on_level_basic */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.nr_of_ports,(LSA_UINT32**)&help_ptr);            /* nr_of_ports */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.nr_of_if,(LSA_UINT32**)&help_ptr);            /* nr_of_if */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.nr_of_all_ports,(LSA_UINT32**)&help_ptr);            /* nr_of_all_ports */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.nr_of_all_if,(LSA_UINT32**)&help_ptr);            /* nr_of_all_if */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.edd_type,(LSA_UINT32**)&help_ptr);            /* edd_type */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.asic_type,(LSA_UINT32**)&help_ptr);            /* asic_type */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.rev_nr,(LSA_UINT32**)&help_ptr);            /* rev_nr */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.allow_none_pnio_mautypes,(LSA_UINT32**)&help_ptr);            /* allow_none_pnio_mautypes */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.send_clock_factor,(LSA_UINT32**)&help_ptr);            /* send_clock_factor */
            for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)                                    /* if_mac*/
            {
                for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                                /* */
                {
                    HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.hd_open.hd_args.if_mac[i][j],(LSA_UINT32**)&help_ptr);                /*  */
                }
            }
            for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)                                    /* port_mac*/
            {
                for(j=0;j<PSI_MAC_ADDR_SIZE;j++)                                                /* */
                {
                    HIF_SER_COPY_SHMTH_8((LSA_UINT8*)&new_rqb->args.hd_open.hd_args.port_mac[i][j],(LSA_UINT32**)&help_ptr);                /*  */
                }
            }
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.irte.use_setting,(LSA_UINT32**)&help_ptr);            /* use_setting */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.irte.irt_supported,(LSA_UINT32**)&help_ptr);            /* irt_supported */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.irte.nr_irt_forwarder,(LSA_UINT32**)&help_ptr);            /* nr_irt_forwarder */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.irte.reserved_ram_for_time,(LSA_UINT32**)&help_ptr);            /* reserved_ram_for_time */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.irte.support_irt_flex,(LSA_UINT32**)&help_ptr);            /* support_irt_flex */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.irte.disable_max_port_delay_check,(LSA_UINT32**)&help_ptr);            /* disable_max_port_delay_check */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnip.use_setting,(LSA_UINT32**)&help_ptr);            /* use_setting */
            HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnip.k32fw_trace_level,(LSA_UINT32**)&help_ptr);            /* k32fw_trace_level */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.stdmac.use_setting,(LSA_UINT32**)&help_ptr);            /* use_setting */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.stdmac.gigabit_support,(LSA_UINT32**)&help_ptr);            /* gigabit_support */
            HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.stdmac.nrt_copy_interface,(LSA_UINT32**)&help_ptr);            /* nrt_copy_interface */
            for(i=0;i<PSI_CFG_MAX_PORT_CNT;i++)                                    /* hw_port*/
            {
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hw_port[i].if_nr,(LSA_UINT32**)&help_ptr);                /* if_nr */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.hw_port[i].user_nr,(LSA_UINT32**)&help_ptr);                /* user_nr */
                HIF_SER_COPY_SHMTH_16((PSI_RINGPORT_TYPE*)&new_rqb->args.hd_open.hd_args.hw_port[i].mrp_ringport_type,(LSA_UINT32**)&help_ptr);                /* mrp_ringport_type */
            }
            for(i=0;i<PSI_CFG_MAX_HD_IF_CNT;i++)                                    /* pnio_if*/
            {
                HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.hd_open.hd_args.pnio_if[i].if_id,(LSA_UINT32**)&help_ptr);                /* if_id */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].edd_if_id,(LSA_UINT32**)&help_ptr);                /* edd_if_id */
                HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.hd_open.hd_args.pnio_if[i].trace_idx,(LSA_UINT32**)&help_ptr);                /* trace_idx */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_rt_devices,(LSA_UINT32**)&help_ptr);                /* nr_of_rt_devices */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_irt_devices,(LSA_UINT32**)&help_ptr);                /* nr_of_irt_devices */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_qv_provider,(LSA_UINT32**)&help_ptr);                /* nr_of_qv_provider */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_qv_consumer,(LSA_UINT32**)&help_ptr);                /* nr_of_qv_consumer */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.logical_addr_space,(LSA_UINT32**)&help_ptr);                /* logical_addr_space */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.nr_of_submod,(LSA_UINT32**)&help_ptr);                /* nr_of_submod */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.max_iocr_data_size,(LSA_UINT32**)&help_ptr);                /* max_iocr_data_size */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.max_mcr_data_size,(LSA_UINT32**)&help_ptr);                /* max_mcr_data_size */
                HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.max_record_length,(LSA_UINT32**)&help_ptr);                /* max_record_length */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.max_alarm_data_length,(LSA_UINT32**)&help_ptr);                /* max_alarm_data_length */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ioc.max_read_implicit,(LSA_UINT32**)&help_ptr);                /* max_read_implicit */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.nr_of_instances,(LSA_UINT32**)&help_ptr);                /* nr_of_instances */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.nr_of_ar,(LSA_UINT32**)&help_ptr);                /* nr_of_ar */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.max_icr_data_size,(LSA_UINT32**)&help_ptr);                /* max_icr_data_size */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.max_ocr_data_size,(LSA_UINT32**)&help_ptr);                /* max_ocr_data_size */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.max_mcr_data_size,(LSA_UINT32**)&help_ptr);                /* max_mcr_data_size */
                HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.max_record_length,(LSA_UINT32**)&help_ptr);                /* max_record_length */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.max_alarm_data_length,(LSA_UINT32**)&help_ptr);                /* max_alarm_data_length */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].iod.nr_of_read_implicit,(LSA_UINT32**)&help_ptr);                /* nr_of_read_implicit */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].cba.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].cba.nr_of_provider_con,(LSA_UINT32**)&help_ptr);                /* nr_of_provider_con */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].cba.nr_of_consumer_con,(LSA_UINT32**)&help_ptr);                /* nr_of_consumer_con */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].cba.nr_of_rt_provider,(LSA_UINT32**)&help_ptr);                /* nr_of_rt_provider */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].cba.nr_of_rt_consumer,(LSA_UINT32**)&help_ptr);                /* nr_of_rt_consumer */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].cba.data_volume_size,(LSA_UINT32**)&help_ptr);                /* data_volume_size */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].ip.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ip.nr_of_send,(LSA_UINT32**)&help_ptr);                /* nr_of_send */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ip.nr_of_arp,(LSA_UINT32**)&help_ptr);                /* nr_of_arp */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ip.nr_of_icmp,(LSA_UINT32**)&help_ptr);                /* nr_of_icmp */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ip.nr_of_udp,(LSA_UINT32**)&help_ptr);                /* nr_of_udp */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].ip.nr_of_tcp ,(LSA_UINT32**)&help_ptr);                /* nr_of_tcp  */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].ip.multicast_support_on,(LSA_UINT32**)&help_ptr);                /* multicast_support_on */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].oha.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].oha.vendor_id,(LSA_UINT32**)&help_ptr);                /* vendor_id */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].oha.device_id,(LSA_UINT32**)&help_ptr);                /* device_id */
                HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.hd_open.hd_args.pnio_if[i].oha.instance_opt,(LSA_UINT32**)&help_ptr);                /* instance_opt */
                HIF_SER_COPY_SHMTH_16((LSA_UINT16*)&new_rqb->args.hd_open.hd_args.pnio_if[i].oha.check_interval,(LSA_UINT32**)&help_ptr);                /* check_interval */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].oha.check_ip_enabled,(LSA_UINT32**)&help_ptr);                /* check_ip_enabled */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].oha.nos_allow_upper_cases,(LSA_UINT32**)&help_ptr);                /* nos_allow_upper_cases */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].mrp.use_setting,(LSA_UINT32**)&help_ptr);                /* use_setting */
                HIF_SER_COPY_SHMTH_8(&new_rqb->args.hd_open.hd_args.pnio_if[i].mrp.max_instances,(LSA_UINT32**)&help_ptr);                /* max_instances */
                HIF_SER_COPY_SHMTH_8(&new_rqb->args.hd_open.hd_args.pnio_if[i].mrp.supported_role,(LSA_UINT32**)&help_ptr);                /* supported_role */
                HIF_SER_COPY_SHMTH_8(&new_rqb->args.hd_open.hd_args.pnio_if[i].mrp.supported_multiple_role,(LSA_UINT32**)&help_ptr);                /* supported_multiple_role */
                HIF_SER_COPY_SHMTH_16((PSI_MRP_ROLE_TYPE*)&new_rqb->args.hd_open.hd_args.pnio_if[i].mrp.default_role_instance0,(LSA_UINT32**)&help_ptr);                /* default_role_instance0 */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].nrt.RxFilterUDP_Unicast,(LSA_UINT32**)&help_ptr);                /* RxFilterUDP_Unicast */
                HIF_SER_COPY_SHMTH_LSA_BOOL(&new_rqb->args.hd_open.hd_args.pnio_if[i].nrt.RxFilterUDP_Broadcast,(LSA_UINT32**)&help_ptr);                /* RxFilterUDP_Broadcast */
            }
        }
    }
    else if (opcode==PSI_OPC_LD_CLOSE_DEVICE)
    {
        /* calculate rqb-size */
        rqb_size=sizeof(PSI_RQB_TYPE) + HIF_SER_SIZEOF(4);        /* RQB-size + original upper RQB pointer */
        help_ptr = (LSA_UINT8*)ptr_rqb_src;

        HIF_ALLOC_LOCAL_MEM(((LSA_VOID**)(&new_rqb)), rqb_size );
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_deserialize_lower() opc(%d) rqb_size(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,new_rqb+4);
        if (HIF_IS_NULL(new_rqb))
        {
            return HIF_ERR_RESOURCE;
        }
        else
        {
            HIF_SER_COPY_SHMTH_32((LSA_UINT32*)new_rqb,(LSA_UINT32**)&help_ptr);            /* orig. upper RQB pointer */
            new_rqb=(PSI_RQB_TYPE*)((LSA_UINT8*)new_rqb+HIF_SER_SIZEOF(4));                                     /* real lower rqb src without orig. upper RQB pointer */
            *ptr_ptr_rqb_dest = new_rqb;                                    /* return real lower rqb src without orig. upper RQB pointer */

            /* restore Lower RQB */
            HIF_RQB_SET_OPCODE(new_rqb,opcode);                        /* _opcode */
            help_ptr+=4;                        /* skip opcode on shared-mem */
            HIF_SER_COMP_ID_SHMTH(&comp_id,(LSA_UINT32**)&help_ptr);                        /* _comp_id */
            HIF_RQB_SET_COMP_ID(new_rqb,comp_id);                                                 /* _comp_id */
        }
    }
    else if (opcode==PSI_OPC_HD_CLOSE_DEVICE)
    {
        /* calculate rqb-size */
        rqb_size=sizeof(PSI_RQB_TYPE) + HIF_SER_SIZEOF(4);        /* RQB-size + original upper RQB pointer */
        help_ptr = (LSA_UINT8*)ptr_rqb_src;

        HIF_ALLOC_LOCAL_MEM(((LSA_VOID**)(&new_rqb)), rqb_size );
        HIF_PROGRAM_TRACE_04(0,LSA_TRACE_LEVEL_NOTE_LOW,"hif_psi_deserialize_lower() opc(%d) rqb_size(%d) shm_addr(0x%08x) pRQB(0x%08x)",opcode,rqb_size,help_ptr,new_rqb+4);
        if (HIF_IS_NULL(new_rqb))
        {
            return HIF_ERR_RESOURCE;
        }
        else
        {
            HIF_SER_COPY_SHMTH_32((LSA_UINT32*)new_rqb,(LSA_UINT32**)&help_ptr);            /* orig. upper RQB pointer */
            new_rqb=(PSI_RQB_TYPE*)((LSA_UINT8*)new_rqb+HIF_SER_SIZEOF(4));                                     /* real lower rqb src without orig. upper RQB pointer */
            *ptr_ptr_rqb_dest = new_rqb;                                    /* return real lower rqb src without orig. upper RQB pointer */

            /* restore Lower RQB */
            HIF_RQB_SET_OPCODE(new_rqb,opcode);                        /* _opcode */
            help_ptr+=4;                        /* skip opcode on shared-mem */
            HIF_SER_COMP_ID_SHMTH(&comp_id,(LSA_UINT32**)&help_ptr);                        /* _comp_id */
            HIF_RQB_SET_COMP_ID(new_rqb,comp_id);                                                 /* _comp_id */
            HIF_SER_COPY_SHMTH_32((LSA_UINT32*)&new_rqb->args.hd_close.hd_id,(LSA_UINT32**)&help_ptr);            /* hd_id */
        }
    }
    else
    {
        HIF_PROGRAM_TRACE_03(0,LSA_TRACE_LEVEL_FATAL,"hif_psi_deserialize_lower(). RQB-Opcode:0x%x is not valid! shm_addr(0x%08x) pRQB(0x%08x)", opcode, ptr_rqb_src, new_rqb+4);
        HIF_FATAL(0);
    }
    HIF_ASSERT(HIF_IS_NOT_NULL(new_rqb)); /*#16*/
    HIF_RQB_SET_COMP_ID(new_rqb, LSA_COMP_ID_PSI);            /* set comp id */
    *ptr_ptr_rqb_dest = new_rqb;

    /* Check for overwrite */
    HIF_SHM_CHECK_OVERWRITE_DESERIALIZE(ptr_rqb_src, opcode, help_ptr, "hif_psi_deserialize_lower");

    return HIF_OK;
}



#endif /* of HIF_CFG_USE_PSI */
#if defined( TOOL_CHAIN_MICROSOFT ) /* Microsoft Visual C++ */
#pragma component(browser, on, references)
#endif
/*****************************************************************************/
/* End of File                                                               */
/*****************************************************************************/
